<link rel="import" href="/SignIn/elements/signin-element.html" />

<template>
    <template is="dom-bind">
        <h2>Sign-in!</h2>
        <form on-submit="preventSubmit">
            <div>
                <template is="dom-if" if="{{model.Message}}">
                    <p class="alert alert-danger">{{model.Message}}</p>
                </template>
            </div>
            <div class="form-horizontal" juicy-style="width: 10%; height: 45px;">
                <label class="control-label" for="txtUsername">Username</label>
            </div>
            <div juicy-style="width: 90%; height: 45px;">
                <input id="txtUsername" name="username" type="text" value="{{local.username::input}}" placeholder="Username" class="form-control" on-keypress="txtKeypress" />
            </div>
            <div class="form-horizontal" juicy-style="width: 10%; height: 45px;">
                <label class="control-label" for="txtPassword">Password</label>
            </div>
            <div juicy-style="width: 90%; height: 45px;">
                <input id="txtPassword" name="password" type="password" value="{{local.password::input}}" placeholder="Password" class="form-control" on-keypress="txtKeypress" />
            </div>
            <div juicy-style="width: 90%; height: 45px;">
                <div class="checkbox">
                    <label>
                        <input type="checkbox" checked="{{local.rememberMe::change}}" />
                        <span>Remember me</span>
                    </label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary" value="{{model.SignInClick$::click}}" disabled="{{model.SignInClick$}}" onmouseup="++this.value;" juicy-style="width: 74px; height: 30px;">Sign in</button>
            <button type="button" class="btn btn-link" value="{{model.RestoreClick$::click}}" disabled="{{model.RestoreClick$::click}}" onmouseup="++this.value;" juicy-style="width: 100px; height: 30px;">Forgot password?</button>
            <signin-element username="{{local.username}}" password="{{local.password}}" remember-me="{{local.rememberMe}}" submit="{{model.Submit}}" referer="{{model.Referer}}"></signin-element>
        </form>
    </template>
    <script>
        (function () {
            var script = document._currentScript || document.currentScript;
            var template = script.previousElementSibling;

            template.local = {
                username: "",
                password: "",
                rememberMe: false
            };

            template.preventSubmit = function(e) {
                e.preventDefault();
            };

            template.txtKeypress = function (e) {
                if (e.which != 13) {
                    return;
                }

                setTimeout(function () {
                    template.set("model.SignInClick$", template.model.SignInClick$ + 1);
                });
            };
        })();
    </script>
</template>
